

<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title> [ Swithun Blog ]</title>

  
  <!-- stylesheets list from _config.yml -->
  
  <link rel="stylesheet" href="/lib/font-awesome-4.7.0/css/font-awesome.min.css">
  
  <link rel="stylesheet" href="/lib/highlight-11-9-0/src/styles/atom-one-dark.css">
  
  <link rel="stylesheet" href="/css/again.css">
  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>

  <!-- menu -->
  <div id="menu-outer">
    <div id="menu-inner">
      
      <a class="menu-button" href="/">Home</a>
      
      <a class="menu-button" href="/about">About</a>
      
      <a class="menu-button" href="/contact">Contact</a>
      
      <a class="menu-button" href="/archives">Archives</a>
      
      <a class="menu-button" href="/categories">Category</a>
      
    </div>
  </div>

  <!-- 中间主体 -->
  <div id="main">
    <!-- 侧边栏 -->
    <div id="aside-outer">
      <aside>
        <!-- 搜索栏 -->
<div id="search">
    <input class="search-input" type="text" placeholder="search">
    <i id="search-icon" class="fa fa-bars" title="切换目录与索引"></i>
</div>

<!-- 侧边目录栏 -->
<div id="tree">
    

    

                <!--如果是文件夹-->
                <ul>
                    <li class="directory">
                        <a href="#" class="directory">
                            <i class="fa fa-folder"></i>
                            Android
                        </a>
                        
                <!--如果是文章-->
                <ul>
                    <li class="file">
                        <a href="/2023/10/18/Android/Fragment原理/">
                            <i class="fa fa-file"></i>
                            Fragment原理
                        </a>
                    </li>
                </ul>

              
                <!--如果是文章-->
                <ul>
                    <li class="file">
                        <a href="/2023/10/10/Android/viewmodel原理/">
                            <i class="fa fa-file"></i>
                            viewmodel原理
                        </a>
                    </li>
                </ul>

              
                <!--如果是文章-->
                <ul>
                    <li class="file">
                        <a href="/2024/03/03/Android/view绘制原理/">
                            <i class="fa fa-file"></i>
                            view绘制原理
                        </a>
                    </li>
                </ul>

              
                <!--如果是文章-->
                <ul>
                    <li class="file">
                        <a href="/2024/03/09/Android/自定义View实现拖拽展开面板/">
                            <i class="fa fa-file"></i>
                            自定义View实现拖拽展开面板
                        </a>
                    </li>
                </ul>

              
                <!--如果是文章-->
                <ul>
                    <li class="file">
                        <a href="/2024/05/12/Android/NestedScrolling原理/">
                            <i class="fa fa-file"></i>
                            NestedScrolling原理
                        </a>
                    </li>
                </ul>

              
                <!--如果是文章-->
                <ul>
                    <li class="file">
                        <a href="/2024/05/25/Android/自己实现一个NestedScrollView/">
                            <i class="fa fa-file"></i>
                            自己实现一个NestedScrollView
                        </a>
                    </li>
                </ul>

              
                <!--如果是文章-->
                <ul>
                    <li class="file">
                        <a href="/2024/06/02/Android/EditText光标定位原理/">
                            <i class="fa fa-file"></i>
                            EditText光标定位原理
                        </a>
                    </li>
                </ul>

              
                <!--如果是文章-->
                <ul>
                    <li class="file">
                        <a href="/2024/06/02/Android/一步步解决NestedScrollView嵌套EditText的冲突/">
                            <i class="fa fa-file"></i>
                            一步步解决NestedScrollView嵌套EditText的冲突
                        </a>
                    </li>
                </ul>

              
                <!--如果是文章-->
                <ul>
                    <li class="file">
                        <a href="/2024/06/11/Android/Dialog原理/">
                            <i class="fa fa-file"></i>
                            Dialog原理
                        </a>
                    </li>
                </ul>

              
                <!--如果是文章-->
                <ul>
                    <li class="file">
                        <a href="/2024/07/20/Android/从0实现一个BottomSheetDialog/">
                            <i class="fa fa-file"></i>
                            从0实现一个BottomSheetDialog
                        </a>
                    </li>
                </ul>

              
                <!--如果是文章-->
                <ul>
                    <li class="file">
                        <a href="/2024/08/18/Android/kotlin协程原理/">
                            <i class="fa fa-file"></i>
                            kotlin协程原理
                        </a>
                    </li>
                </ul>

              
                <!--如果是文章-->
                <ul>
                    <li class="file">
                        <a href="/2024/09/07/Android/textview measure流程/">
                            <i class="fa fa-file"></i>
                            textview measure流程
                        </a>
                    </li>
                </ul>

              
                <!--如果是文章-->
                <ul>
                    <li class="file">
                        <a href="/2024/03/10/Android/Activity的启动流程/">
                            <i class="fa fa-file"></i>
                            Activity的启动流程
                        </a>
                    </li>
                </ul>

              
                    </li>
                </ul>

                 

                <!--如果是文件夹-->
                <ul>
                    <li class="directory">
                        <a href="#" class="directory">
                            <i class="fa fa-folder"></i>
                            主题演示
                        </a>
                        
                <!--如果是文章-->
                <ul>
                    <li class="file">
                        <a href="/2023/10/10/主题演示/demo1/">
                            <i class="fa fa-file"></i>
                            demo1
                        </a>
                    </li>
                </ul>

              
                <!--如果是文章-->
                <ul>
                    <li class="file">
                        <a href="/2023/10/22/主题演示/temp/">
                            <i class="fa fa-file"></i>
                            temp
                        </a>
                    </li>
                </ul>

              

                <!--如果是文件夹-->
                <ul>
                    <li class="directory">
                        <a href="#" class="directory">
                            <i class="fa fa-folder"></i>
                            demo_folder_level2
                        </a>
                        
                <!--如果是文章-->
                <ul>
                    <li class="file">
                        <a href="/2023/10/10/主题演示/demo_folder_level2/demo2/">
                            <i class="fa fa-file"></i>
                            demo2
                        </a>
                    </li>
                </ul>

              
                    </li>
                </ul>

                 
                    </li>
                </ul>

                 

                <!--如果是文件夹-->
                <ul>
                    <li class="directory">
                        <a href="#" class="directory">
                            <i class="fa fa-folder"></i>
                            AOSP
                        </a>
                        

                <!--如果是文件夹-->
                <ul>
                    <li class="directory">
                        <a href="#" class="directory">
                            <i class="fa fa-folder"></i>
                            java
                        </a>
                        

                <!--如果是文件夹-->
                <ul>
                    <li class="directory">
                        <a href="#" class="directory">
                            <i class="fa fa-folder"></i>
                            lang
                        </a>
                        
                <!--如果是文章-->
                <ul>
                    <li class="file">
                        <a href="/2024/10/07/AOSP/java/lang/ThreadLocal/">
                            <i class="fa fa-file"></i>
                            ThreadLocal
                        </a>
                    </li>
                </ul>

              
                <!--如果是文章-->
                <ul>
                    <li class="file">
                        <a href="/2025/01/04/AOSP/java/lang/Thread/">
                            <i class="fa fa-file"></i>
                            Thread
                        </a>
                    </li>
                </ul>

              
                    </li>
                </ul>

                 

                <!--如果是文件夹-->
                <ul>
                    <li class="directory">
                        <a href="#" class="directory">
                            <i class="fa fa-folder"></i>
                            util
                        </a>
                        

                <!--如果是文件夹-->
                <ul>
                    <li class="directory">
                        <a href="#" class="directory">
                            <i class="fa fa-folder"></i>
                            concurrent
                        </a>
                        

                <!--如果是文件夹-->
                <ul>
                    <li class="directory">
                        <a href="#" class="directory">
                            <i class="fa fa-folder"></i>
                            ThreadPoolExecutor
                        </a>
                        
                <!--如果是文章-->
                <ul>
                    <li class="file">
                        <a href="/2024/01/04/AOSP/java/util/concurrent/ThreadPoolExecutor/Worker/">
                            <i class="fa fa-file"></i>
                            Worker
                        </a>
                    </li>
                </ul>

              
                    </li>
                </ul>

                 
                <!--如果是文章-->
                <ul>
                    <li class="file">
                        <a href="/2024/12/28/AOSP/java/util/concurrent/LinkedBlockingQueue/">
                            <i class="fa fa-file"></i>
                            LinkedBlockingQueue
                        </a>
                    </li>
                </ul>

              
                    </li>
                </ul>

                 
                    </li>
                </ul>

                 
                    </li>
                </ul>

                 
                    </li>
                </ul>

                 

                <!--如果是文件夹-->
                <ul>
                    <li class="directory">
                        <a href="#" class="directory">
                            <i class="fa fa-folder"></i>
                            multi_thread
                        </a>
                        
                <!--如果是文章-->
                <ul>
                    <li class="file">
                        <a href="/2024/12/08/multi_thread/Test/">
                            <i class="fa fa-file"></i>
                            Test
                        </a>
                    </li>
                </ul>

              
                <!--如果是文章-->
                <ul>
                    <li class="file">
                        <a href="/2024/12/08/multi_thread/ThreadPool/">
                            <i class="fa fa-file"></i>
                            ThreadPool
                        </a>
                    </li>
                </ul>

              
                    </li>
                </ul>

                 
</div>

<div id="toc" style="display: none;"></div>
      </aside>
    </div>
    <!-- 文章内容 -->
    <div id="content-outer">
      <div id="content-inner">
        <body>



  
<div id="recent-posts">
  <h1>Recent Posts</h1>
  
  <div class="recent-post-item">


    <div class="recent-post-left">
      <img class="recent-post-img"
        src="https://www.dmoe.cc/random.php" />
    </div>

    <div class="recent-post-right">

      <a class="recent-post-title" href="/2025/01/04/AOSP/java/lang/Thread/">Thread</a>
      <time class="recent-post-time" datetime="2025-01-04T07:30:05.000Z">
        2025-01-04
      </time>

      <div class="article-digest">
        run()(begin@@@1735975874)
    @Override
    public void run() &#123;
        if (target != null) &#123;
            target.run();
        &#125;
    &#125;

(end@@@1735975874)

        ...
      </div>

    </div>

  </div>
  
  <div class="recent-post-item">


    <div class="recent-post-left">
      <img class="recent-post-img"
        src="https://www.dmoe.cc/random.php" />
    </div>

    <div class="recent-post-right">

      <a class="recent-post-title" href="/2024/12/29/AOSP/java/util/concurrent/ThreadPoolExecutor/">ThreadPoolExecutor</a>
      <time class="recent-post-time" datetime="2024-12-29T06:46:49.000Z">
        2024-12-29
      </time>

      <div class="article-digest">
        ThreadPoolExecutorctl @@状态&amp;线程数
前3位用来表示状态，一共可以用来表示2 * 2 * 8种状态
剩余位数用来表示线程数

    private final AtomicInteger ctl = new AtomicInteger(ctlOf(RUNNING, 0));
    private static final int COUNT_BITS = Integer.SIZE - 3; // 32 - 3 = 29
    // (1 &lt;&lt; 29) - 1 
    // = (1左移29位) - 1 
    // = 2^29 - 1 =
        ...
      </div>

    </div>

  </div>
  
  <div class="recent-post-item">


    <div class="recent-post-left">
      <img class="recent-post-img"
        src="https://www.dmoe.cc/random.php" />
    </div>

    <div class="recent-post-right">

      <a class="recent-post-title" href="/2024/12/28/AOSP/java/util/concurrent/LinkedBlockingQueue/">LinkedBlockingQueue</a>
      <time class="recent-post-time" datetime="2024-12-28T15:10:18.000Z">
        2024-12-28
      </time>

      <div class="article-digest">
        offer    final AtomicInteger count = this.count;

    private final ReentrantLock putLock = new ReentrantLock();

    public boolean offer(E e) &#123;
        ...
        // 1. 已经满了，返回false
        if (count.get() == capacity)
            return false;
        // 2. 还没满
        final int c;
        
        ...
      </div>

    </div>

  </div>
  
  <div class="recent-post-item">


    <div class="recent-post-left">
      <img class="recent-post-img"
        src="https://www.dmoe.cc/random.php" />
    </div>

    <div class="recent-post-right">

      <a class="recent-post-title" href="/2024/12/08/multi_thread/Test/"></a>
      <time class="recent-post-time" datetime="2024-12-08T09:53:04.811Z">
        2024-12-08
      </time>

      <div class="article-digest">
        
        ...
      </div>

    </div>

  </div>
  
  <div class="recent-post-item">


    <div class="recent-post-left">
      <img class="recent-post-img"
        src="https://www.dmoe.cc/random.php" />
    </div>

    <div class="recent-post-right">

      <a class="recent-post-title" href="/2024/12/08/multi_thread/ThreadPool/">ThreadPool</a>
      <time class="recent-post-time" datetime="2024-12-08T09:44:28.000Z">
        2024-12-08
      </time>

      <div class="article-digest">
        简易线程池实现class SimpleThreadPool(threadSize: Int) &#123;
    /** 1. 任务队列: 线程安全*/
    val taskQueue: BlockingQueue&lt;Runnable&gt; = LinkedBlockingQueue(10)

    /** 2. 所有线程: worker */
    val threads = ArrayList&lt;SimpleThread&gt;(threadSize)

    init &#123;
        // 3 启动所有线程
        (1..threadSize
        ...
      </div>

    </div>

  </div>
  
  <div class="recent-post-item">


    <div class="recent-post-left">
      <img class="recent-post-img"
        src="https://www.dmoe.cc/random.php" />
    </div>

    <div class="recent-post-right">

      <a class="recent-post-title" href="/2024/10/07/AOSP/java/lang/ThreadLocal/">ThreadLocal</a>
      <time class="recent-post-time" datetime="2024-10-07T11:28:29.000Z">
        2024-10-07
      </time>

      <div class="article-digest">
        setsequenceDiagram
participant Other
participant T as ThreadLocal
participant ThreadS as Thread(类)
participant Thread
participant TT as ThreadLocal.ThreadLocalMap

Other ->> T: new
T -->> Other: threadLocal
Other ->> T: set(T value)
T ->> ThreadS: currentThead()
ThreadS ->> T: Thread(当前线程)
T ->> Thr
        ...
      </div>

    </div>

  </div>
  
  <div class="recent-post-item">


    <div class="recent-post-left">
      <img class="recent-post-img"
        src="https://www.dmoe.cc/random.php" />
    </div>

    <div class="recent-post-right">

      <a class="recent-post-title" href="/2024/09/07/Android/textview%20measure%E6%B5%81%E7%A8%8B/">measure流程</a>
      <time class="recent-post-time" datetime="2024-09-07T10:29:47.000Z">
        2024-09-07
      </time>

      <div class="article-digest">
        
        ...
      </div>

    </div>

  </div>
  
  <div class="recent-post-item">


    <div class="recent-post-left">
      <img class="recent-post-img"
        src="https://www.dmoe.cc/random.php" />
    </div>

    <div class="recent-post-right">

      <a class="recent-post-title" href="/2024/08/18/Android/kotlin%E5%8D%8F%E7%A8%8B%E5%8E%9F%E7%90%86/">kotlin协程原理</a>
      <time class="recent-post-time" datetime="2024-08-18T11:41:40.000Z">
        2024-08-18
      </time>

      <div class="article-digest">
        import kotlinx.coroutines.delay
import kotlinx.coroutines.suspendCancellableCoroutine
import kotlin.coroutines.resume

suspend fun testDelay(time: Long): Int &#123;
    val a = testDelay1(time)
    val b = testDelay2(time)
    val c = testDelay3(time, &quot;haha&quot;)
    return a + b + c
&#125;
su
        ...
      </div>

    </div>

  </div>
  
  <div class="recent-post-item">


    <div class="recent-post-left">
      <img class="recent-post-img"
        src="https://www.dmoe.cc/random.php" />
    </div>

    <div class="recent-post-right">

      <a class="recent-post-title" href="/2024/07/20/Android/%E4%BB%8E0%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AABottomSheetDialog/">从0实现一个BottomSheetDialog</a>
      <time class="recent-post-time" datetime="2024-07-20T14:20:41.000Z">
        2024-07-20
      </time>

      <div class="article-digest">
        特点
可自定义展开段数(即自动吸附的高度)
到达吸附位置有仿 iOS 的回弹效果（可以参考apple地图）
可自定义背景半透明蒙层颜色
实现了 NestedScrollingParent 接口——支持嵌套滚动

演示
常见的 关闭 -&gt; 半展开 -&gt; 全展开效果





嵌套滚动 2. 背景蒙层颜色修改为更深的紫色






自定义为4段吸附



代码BottomSheetDialog – 继承该类实现自己的Dialogimport android.os.Bundle
import android.view.LayoutInflater
import android.view
        ...
      </div>

    </div>

  </div>
  
  <div class="recent-post-item">


    <div class="recent-post-left">
      <img class="recent-post-img"
        src="https://www.dmoe.cc/random.php" />
    </div>

    <div class="recent-post-right">

      <a class="recent-post-title" href="/2024/06/11/Android/Dialog%E5%8E%9F%E7%90%86/">Dialog原理</a>
      <time class="recent-post-time" datetime="2024-06-11T07:20:35.000Z">
        2024-06-11
      </time>

      <div class="article-digest">
        
        ...
      </div>

    </div>

  </div>
  
</div>


  <div id="paginator">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">Next</a>
  </div>


</div>
      </div>
    </div>

  </div>

  <!-- 底部信息 -->
  <div id="bottom-outer">
    <div id="bottom-inner">
      Site by Swithun Liu using
      <a target="_blank" rel="noopener" href="http://hexo.io">hexo blog framework</a>.
      <br>
      <a href="/">Home</a>
    </div>
  </div>


  
  <!-- scripts list from theme config.yml -->
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.0.0-alpha1/highlight.min.js"></script>
  
  <script src="/lib/jquery-3.4.1.min.js"></script>
  
  <script src="/lib/jquery.pjax.js"></script>
  
  <script src="/js/again.js"></script>
  
  


  <!-- 高亮脚本启动 -->
  <script>hljs.initHighlightingOnLoad();</script>

    <!-- 如果设置中mermaid选项打开 -->
    
    <!-- 引入mermaid脚本 -->
    <div class=".pjax-reload">
      <script src='https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.3.0/mermaid.min.js'></script>
    </div>
    <!-- mermaid启动 -->
    <script>
      if (window.mermaid) {
        mermaid.initialize({ theme: 'dark' });
      }
    </script>
    

</body>

</html>