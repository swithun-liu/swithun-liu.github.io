---
title: Condition
date: 2025-01-11 14:20:00
tags:
---

## await

- 描述：
使当前线程等待，直到它被唤醒或被中断。
当调用 await 方法时，当前线程将自动释放与此 Condition 关联的锁，并在以下四种情况下之一发生前，线程会被禁用线程调度功能并处于休眠状态：
  - 其他线程调用此 Condition 的 signal 方法，并且当前线程被选中为唤醒线程；
  - 其他线程调用此 Condition 的 signalAll 方法；
  - 其他线程中断了当前线程（并且支持线程挂起的中断）；
  - 出现“伪唤醒（spurious wakeup）”。

  注意事项：
  无论上述哪种情况，在此方法返回之前，当前线程必须**重新获取与该条件关联的锁**。当线程返回时，保证它持有该锁。

- 中断情况：
    如果当前线程：
    - 在进入此方法时，其中断状态已被设置；
    - 或在等待时被中断，并且支持线程挂起的中断；

    那么将抛出 `InterruptedException`，并清除当前线程的中断状态。在第一种情况下，无法保证检查中断状态是否发生在锁释放之前。

- 实现细节和考虑：
假定调用此方法时，当前线程已经持有与该 Condition 关联的锁。
如果没有持有锁，则由具体实现决定如何响应：
通常会抛出异常（如 `IllegalMonitorStateException`），并且实现必须记录这种行为。

- 中断优先级：
实现可以优先响应线程的中断，而不是正常返回（因 signal 唤醒）。
在这种情况下，需确保信号能够传递给其他等待的线程（如果存在）。


- 抛出异常：
InterruptedException：如果当前线程被中断，并且支持线程挂起的中断，则抛出此异常。
